import{n as o,f as c,j as r,g as d,l as m,o as u,p as f,M as _,q as h,m as a,a as l,t as p,u as v,v as C}from"./index-Djh35xFL.js";import{L as y}from"./ListPageHeader-g21-5tZQ.js";const $={name:"custom-action-list",mixins:[c],props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},data(){return{}},components:{RowActionsCell:r,TableInfo:d}};var x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-list"},[e("div",{staticClass:"datatable-wrapper"},[e("table",{staticClass:"datatable"},[e("thead",{staticClass:"datatable-head"},[e("tr",[e("th",{staticClass:"name",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("custom_actions.fields.name"))+" ")]),e("th",{staticClass:"url",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("custom_actions.fields.url"))+" ")]),e("th",{staticClass:"entity-type",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("custom_actions.fields.entity_type"))+" ")]),e("th",{staticClass:"is-ajax",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("custom_actions.fields.is_ajax"))+" ")]),e("th",{staticClass:"actions",attrs:{scope:"col"}},[t._v("Â ")])])]),e("tbody",{staticClass:"datatable-body"},t._l(t.entries,function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("td",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(s.name)+" ")]),e("td",{staticClass:"url"},[t._v(t._s(s.url))]),e("td",{staticClass:"entity-type"},[t._v(t._s(s.entity_type))]),e("td",{staticClass:"is-ajax"},[t._v(" "+t._s(t.formatBoolean(s.is_ajax))+" ")]),e("row-actions-cell",{attrs:{"entry-id":s.id},on:{"edit-clicked":function(n){return t.$emit("edit-clicked",s)},"delete-clicked":function(n){return t.$emit("delete-clicked",s)}}})],1)}),0)])]),e("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),e("p",{staticClass:"has-text-centered nb-custom-actions"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("custom_actions.number",t.entries.length))+" ")])],1)},b=[],A=o($,x,b,!1,null,"ade8382e",null,null);const T=A.exports,g={name:"edit-custom-action-modal",mixins:[m],components:{Combobox:u,ComboboxBoolean:f,ModalFooter:_,TextField:h},props:{active:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},customActionToEdit:{type:Object,default:()=>{}}},data(){return{form:{name:"",url:"",entityType:"all",isAjax:"false"},entityTypeOptions:[{label:"all",value:"all"},{label:"asset",value:"asset"},{label:"shot",value:"shot"}]}},computed:{...a(["customActions","customActionStatusOptions"])},methods:{...l([]),confirmClicked(){this.$emit("confirm",this.form)},isEditing(){return this.customActionToEdit&&this.customActionToEdit.id}},watch:{customActionToEdit(){this.customActionToEdit&&(this.form={name:this.customActionToEdit.name,url:this.customActionToEdit.url,entityType:this.customActionToEdit.entity_type,isAjax:(!!this.customActionToEdit.is_ajax).toString()})},active(){this.active&&setTimeout(()=>{this.$refs.nameField.focus()},100)}}};var E=function(){var t=this,e=t._self._c;return e("div",{class:{modal:!0,"is-active":t.active}},[e("div",{staticClass:"modal-background",on:{click:function(s){return t.$emit("cancel")}}}),e("div",{staticClass:"modal-content"},[e("div",{staticClass:"box"},[t.isEditing()?e("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("custom_actions.edit_title"))+" "+t._s(t.customActionToEdit.name)+" ")]):e("h1",{staticClass:"title"},[t._v(" "+t._s(t.$t("custom_actions.new_custom_action"))+" ")]),e("form",{on:{submit:function(s){s.preventDefault()}}},[e("text-field",{directives:[{name:"focus",rawName:"v-focus"}],ref:"nameField",attrs:{label:t.$t("custom_actions.fields.name")},model:{value:t.form.name,callback:function(s){t.$set(t.form,"name",s)},expression:"form.name"}}),e("text-field",{ref:"urlField",attrs:{label:t.$t("custom_actions.fields.url")},on:{enter:t.confirmClicked},model:{value:t.form.url,callback:function(s){t.$set(t.form,"url",s)},expression:"form.url"}}),e("combobox",{attrs:{label:t.$t("custom_actions.fields.entity_type"),options:t.entityTypeOptions,"locale-key-prefix":"custom_actions.entity_types."},on:{enter:t.confirmClicked},model:{value:t.form.entityType,callback:function(s){t.$set(t.form,"entityType",s)},expression:"form.entityType"}}),e("combobox-boolean",{attrs:{label:t.$t("custom_actions.fields.is_ajax")},on:{enter:t.confirmClicked},model:{value:t.form.isAjax,callback:function(s){t.$set(t.form,"isAjax",s)},expression:"form.isAjax"}})],1),e("modal-footer",{attrs:{"error-text":t.$t("custom_actions.create_error"),"is-error":t.isError},on:{confirm:t.confirmClicked,cancel:function(s){return t.$emit("cancel")}}})],1)])])},k=[],w=o(g,E,k,!1,null,"168d933d",null,null);const j=w.exports,D={name:"custom-actions",components:{CustomActionList:T,DeleteModal:p,EditCustomActionModal:j,ListPageHeader:y},data(){return{modals:{edit:!1,del:!1},loading:{edit:!1,del:!1,list:!1},errors:{edit:!1,del:!1,list:!1},customActionToDelete:null,customActionToEdit:null}},computed:{...a(["customActions"]),deleteText(){const i=this.customActionToDelete;return i?this.$t("custom_actions.delete_text",{name:i.name}):""}},created(){this.loading.list=!0,this.errors.list=!1,this.loadCustomActions(i=>{this.loading.list=!1,i&&(this.errors.list=!0)})},methods:{...l(["deleteCustomAction","editCustomAction","loadCustomActions","newCustomAction"]),confirmEditCustomAction(i){let t="newCustomAction";this.customActionToEdit&&this.customActionToEdit.id&&(t="editCustomAction",i.id=this.customActionToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this[t](i).then(()=>{this.loading.edit=!1,this.modals.edit=!1}).catch(e=>{console.error(e),this.errors.edit=!0,this.modals.isNewDisplayed=!1})},confirmDeleteCustomAction(){this.loading.del=!0,this.errors.del=!1,this.deleteCustomAction(this.customActionToDelete).then(()=>{this.loading.del=!1,this.modals.del=!1}).catch(i=>{console.error(i),this.errors.del=!0,this.loading.del=!1})},onExportClicked(){const i=v.slugify(this.$t("custom_actions.title")),e=[[this.$t("main.type"),this.$t("custom_actions.fields.name"),this.$t("custom_actions.fields.url"),this.$t("custom_actions.fields.entity_type"),this.$t("custom_actions.fields.is_ajax")]].concat(this.customActions.map(s=>[s.type,s.name,s.url,s.entity_type,s.is_ajax]));C.buildCsvFile(i,e)},onNewClicked(){this.customActionToEdit={},this.errors.edit=!1,this.modals.edit=!0},onEditClicked(i){this.customActionToEdit=i,this.errors.edit=!1,this.modals.edit=!0},onDeleteClicked(i){this.customActionToDelete=i,this.errors.del=!1,this.modals.del=!0}},watch:{$route(){this.handleModalsDisplay()}},metaInfo(){return{title:`${this.$t("custom_actions.title")} - Kitsu`}}};var F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-actions page fixed-page"},[e("list-page-header",{attrs:{title:t.$t("custom_actions.title"),"new-entry-label":t.$t("custom_actions.new_custom_action")},on:{"export-clicked":t.onExportClicked,"new-clicked":t.onNewClicked}}),e("custom-action-list",{attrs:{entries:t.customActions,"is-loading":t.loading.list,"is-error":t.errors.list},on:{"edit-clicked":t.onEditClicked,"delete-clicked":t.onDeleteClicked}}),e("edit-custom-action-modal",{attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"custom-action-to-edit":t.customActionToEdit},on:{cancel:function(s){t.modals.edit=!1},confirm:t.confirmEditCustomAction}}),e("delete-modal",{attrs:{active:t.modals.del,"is-loading":t.loading.del,"is-error":t.errors.del,text:t.deleteText,"error-text":t.$t("custom_actions.delete_error")},on:{cancel:function(s){t.modals.del=!1},confirm:t.confirmDeleteCustomAction}})],1)},B=[],L=o(D,F,B,!1,null,null,null,null);const O=L.exports;export{O as default};
//# sourceMappingURL=CustomActions-Bf5pAtAg.js.map
